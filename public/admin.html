<!DOCTYPE html>
<html>
<head>
    <title>Admin Monitor</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .sensor-box { margin: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px; }
        .bar-container { width: 100%; height: 30px; background: #ddd; margin-top: 10px; }
        .bar { height: 100%; background: #4CAF50; width: 0%; transition: width 0.3s; }
        #dataLog { height: 200px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; }
    </style>
</head>
<body>
    <h1>Gyro Data Monitor</h1>
    
    <div class="sensor-box">
        <h3>Beta (Vor/Zurück)</h3>
        <div class="bar-container"><div id="betaBar" class="bar"></div></div>
        <span id="betaValue">0°</span>
    </div>
    
    <div class="sensor-box">
        <h3>Gamma (Links/Rechts)</h3>
        <div class="bar-container"><div id="gammaBar" class="bar"></div></div>
        <span id="gammaValue">0°</span>
    </div>
    
    <h3>Raw Data:</h3>
    <div id="dataLog"></div>

    <script>
        const socket = new WebSocket("wss://gyroengine.onrender.com");
        const betaBar = document.getElementById("betaBar");
        const gammaBar = document.getElementById("gammaBar");
        const betaValue = document.getElementById("betaValue");
        const gammaValue = document.getElementById("gammaValue");
        const dataLog = document.getElementById("dataLog");

        socket.onmessage = (e) => {
            const data = JSON.parse(e.data);
            
            // Nur Gyro-Daten anzeigen (keine Reset-Kommandos)
            if (data.beta !== undefined && data.gamma !== undefined) {
                // Balken aktualisieren (Skalierung: -90° bis +90°)
                updateBar(betaBar, data.beta, 90);
                updateBar(gammaBar, data.gamma, 90);
                
                // Werte anzeigen
                betaValue.textContent = `${data.beta.toFixed(1)}°`;
                gammaValue.textContent = `${data.gamma.toFixed(1)}°`;
                
                // Log-Eintrag
                dataLog.innerHTML += `Beta: ${data.beta.toFixed(1)}° | Gamma: ${data.gamma.toFixed(1)}°<br>`;
                dataLog.scrollTop = dataLog.scrollHeight;
            }
        };

        function updateBar(barElement, value, max) {
            const percentage = ((value + max) / (max * 2)) * 100;
            barElement.style.width = `${percentage}%`;
            
            // Farbe ändern bei Extremwerten
            if (Math.abs(value) > max * 0.8) {
                barElement.style.background = "#f44336";
            } else {
                barElement.style.background = "#4CAF50";
            }
        }
    </script>
</body>
</html>
